Total parameters: 249221
Epoch 1/150
----------
  0%|[34m                                                                                                                                                                       [39m| 0/52 [00:00<?, ?it/s]C:\Users\ASUS\anaconda3\envs\gpu_torch_5\Lib\site-packages\torch\nn\functional.py:5476: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at C:\cb\pytorch_1000000000000\work\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:263.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)










100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:22<00:00,  2.29it/s]

 69%|[32m████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 [39m| 24/35 [00:02<00:01,  8.28it/s]
Total time:26.79140067100525
Loss: 5.394547238783403
Validation Loss: 5.6783788264881485
HGR Accuracy: tensor(0.0842, device='cuda:0')
ID Accuracy: tensor(0.1085, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:04<00:00,  8.55it/s]
  2%|[34m███                                                                                                                                                            [39m| 1/52 [00:00<00:22,  2.25it/s]
Epoch 2/150











100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:23<00:00,  2.19it/s]

100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:04<00:00,  8.00it/s]
  2%|[34m███                                                                                                                                                            [39m| 1/52 [00:00<00:23,  2.18it/s]
Total time:28.142711400985718
Loss: 5.3841277740940905
Validation Loss: 5.679278039065275
HGR Accuracy: tensor(0.0848, device='cuda:0')
ID Accuracy: tensor(0.0994, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 3/150












100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:25<00:00,  2.02it/s]

100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:04<00:00,  7.64it/s]
  0%|[34m                                                                                                                                                                       [39m| 0/52 [00:00<?, ?it/s]
Total time:30.370817184448242
Loss: 5.598513041409579
Validation Loss: 5.678854519237172
HGR Accuracy: tensor(0.0970, device='cuda:0')
ID Accuracy: tensor(0.0958, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 4/150













100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:27<00:00,  1.91it/s]

100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:04<00:00,  7.33it/s]
  0%|[34m                                                                                                                                                                       [39m| 0/52 [00:00<?, ?it/s]
Total time:32.03606963157654
Loss: 5.4363313299236875
Validation Loss: 5.677341821843927
HGR Accuracy: tensor(0.0812, device='cuda:0')
ID Accuracy: tensor(0.1012, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 5/150













100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:27<00:00,  1.90it/s]

100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:04<00:00,  7.17it/s]
  0%|[34m                                                                                                                                                                       [39m| 0/52 [00:00<?, ?it/s]
Total time:32.31516361236572
Loss: 5.456789999875156
Validation Loss: 4.700481407859109
HGR Accuracy: tensor(0.0794, device='cuda:0')
ID Accuracy: tensor(0.0952, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 6/150














100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:28<00:00,  1.80it/s]

100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.67it/s]
  0%|[34m                                                                                                                                                                       [39m| 0/52 [00:00<?, ?it/s]
Total time:34.15003514289856
Loss: 4.786178980740634
Validation Loss: 4.700481588190252
HGR Accuracy: tensor(0.0952, device='cuda:0')
ID Accuracy: tensor(0.0994, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 7/150














100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:28<00:00,  1.83it/s]

100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.84it/s]
  0%|[34m                                                                                                                                                                       [39m| 0/52 [00:00<?, ?it/s]
Total time:33.61560010910034
Loss: 5.148314481793028
Validation Loss: 5.719869200966575
HGR Accuracy: tensor(0.0855, device='cuda:0')
ID Accuracy: tensor(0.0933, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 8/150














100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:30<00:00,  1.72it/s]


100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  5.93it/s]
  0%|[34m                                                                                                                                                                       [39m| 0/52 [00:00<?, ?it/s]
Total time:36.1093327999115
Loss: 5.711313856876258
Validation Loss: 5.72208439393477
HGR Accuracy: tensor(0.0909, device='cuda:0')
ID Accuracy: tensor(0.1000, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 9/150















100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:31<00:00,  1.63it/s]


100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.05it/s]
  0%|[34m                                                                                                                                                                       [39m| 0/52 [00:00<?, ?it/s]
Total time:37.709715843200684
Loss: 5.703743432362875
Validation Loss: 5.712600378556685
HGR Accuracy: tensor(0.0909, device='cuda:0')
ID Accuracy: tensor(0.1000, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 10/150














100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:30<00:00,  1.70it/s]



 94%|[32m████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         [39m| 33/35 [00:05<00:00,  5.74it/s]
Total time:36.80261826515198
Loss: 5.69613809932362
Validation Loss: 5.702462635040283
HGR Accuracy: tensor(0.0909, device='cuda:0')
ID Accuracy: tensor(0.1000, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 11/150
100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.66it/s]














100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:30<00:00,  1.70it/s]


100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.38it/s]
  2%|[34m███                                                                                                                                                            [39m| 1/52 [00:00<00:28,  1.82it/s]
Total time:37.173298835754395
Loss: 5.686396759495591
Validation Loss: 5.694249851920388
HGR Accuracy: tensor(0.0909, device='cuda:0')
ID Accuracy: tensor(0.1000, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 12/150















100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:31<00:00,  1.67it/s]


100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.21it/s]
Total time:36.81360149383545
Loss: 5.68168431484338
Validation Loss: 5.690320264642889
HGR Accuracy: tensor(0.0897, device='cuda:0')
ID Accuracy: tensor(0.1000, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 13/150
----------














100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:31<00:00,  1.67it/s]


 86%|[32m███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      [39m| 30/35 [00:04<00:00,  6.13it/s]
Total time:36.7686448097229
Loss: 5.676722371650465
Validation Loss: 5.688394341902299
HGR Accuracy: tensor(0.0897, device='cuda:0')
ID Accuracy: tensor(0.0994, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 14/150
100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.28it/s]















100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:32<00:00,  1.62it/s]


 86%|[32m███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      [39m| 30/35 [00:04<00:00,  6.18it/s]
Total time:37.60657358169556
Loss: 5.671598824587735
Validation Loss: 5.683690365878019
HGR Accuracy: tensor(0.0903, device='cuda:0')
ID Accuracy: tensor(0.1030, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 15/150
100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.29it/s]














100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:31<00:00,  1.67it/s]


100%|[32m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.15it/s]
  2%|[34m███                                                                                                                                                            [39m| 1/52 [00:00<00:29,  1.73it/s]
Total time:36.81596755981445
Loss: 5.6611968132943815
Validation Loss: 5.681917093450373
HGR Accuracy: tensor(0.0988, device='cuda:0')
ID Accuracy: tensor(0.0988, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 16/150















100%|[34m██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████[39m| 52/52 [00:31<00:00,  1.65it/s]

 77%|[32m█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                    [39m| 27/35 [00:04<00:01,  5.85it/s]
Traceback (most recent call last):
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\trainer.py", line 85, in <module>
    train_metrics, val_metrics = train_val(train_dataLoader,
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\epoch.py", line 166, in train_val
    loss_hgr_val_curr, loss_id_val_curr, loss_icgd_val_curr, loss_val_curr, acc_hgr_val_curr, acc_id_val_curr = val_epoch(val_loader,
                                                                                                                ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\epoch.py", line 94, in val_epoch
    loss_icgd_batch = obj_icgd(y_hgr,y_id,f_theta) # ICGD Loss
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS\anaconda3\envs\gpu_torch_5\Lib\site-packages\torch\nn\modules\module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS\anaconda3\envs\gpu_torch_5\Lib\site-packages\torch\nn\modules\module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\icgd.py", line 62, in forward
    id_mask = self.get_IDmask(y_id) # ID mask, shape -> (B,B)
              ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\icgd.py", line 33, in get_IDmask
    id_mask_dist = torch.logical_not(torch.eye(B).to(torch.bool)).to(device_id,dtype=torch.float32) # Except diagonal entries everything turned high
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt