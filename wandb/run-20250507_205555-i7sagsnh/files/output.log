Total parameters: 249221
Epoch 1/150
----------
  0%|[34m                                                            [39m| 0/52 [00:00<?, ?it/s]C:\Users\ASUS\anaconda3\envs\gpu_torch_5\Lib\site-packages\torch\nn\functional.py:5476: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at C:\cb\pytorch_1000000000000\work\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:263.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)













100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:28<00:00,  1.83it/s]


 91%|[32m██████████████████████████████████████████████▋    [39m| 32/35 [00:04<00:00,  6.29it/s]
Total time:33.80975151062012
Loss: 5.2714252668438535
Validation Loss: 4.700480703874068
HGR Accuracy: tensor(0.0782, device='cuda:0')
ID Accuracy: tensor(0.0964, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 2/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.54it/s]















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:31<00:00,  1.64it/s]

 69%|[32m██████████████████████████████████▉                [39m| 24/35 [00:03<00:01,  6.16it/s]
Total time:37.44154644012451
Loss: 5.09510073112719
Validation Loss: 4.700480412569913
HGR Accuracy: tensor(0.0879, device='cuda:0')
ID Accuracy: tensor(0.0945, device='cuda:0')
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.10it/s]
  0%|[34m                                                            [39m| 0/52 [00:00<?, ?it/s]
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 3/150
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:32<00:00,  1.58it/s]


 74%|[32m█████████████████████████████████████▉             [39m| 26/35 [00:05<00:01,  5.04it/s]
Total time:39.71062660217285
Loss: 5.073917346723152
Validation Loss: 4.700480742021041
HGR Accuracy: tensor(0.0885, device='cuda:0')
ID Accuracy: tensor(0.0848, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 4/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.17it/s]
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:32<00:00,  1.59it/s]


 94%|[32m████████████████████████████████████████████████   [39m| 33/35 [00:05<00:00,  5.21it/s]
Total time:38.90239357948303
Loss: 5.0823077294320775
Validation Loss: 4.700480816581033
HGR Accuracy: tensor(0.1024, device='cuda:0')
ID Accuracy: tensor(0.0994, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 5/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.71it/s]
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.51it/s]


 86%|[32m███████████████████████████████████████████▋       [39m| 30/35 [00:05<00:00,  5.48it/s]
Total time:40.62489438056946
Loss: 5.124568088993882
Validation Loss: 4.700480249578303
HGR Accuracy: tensor(0.0903, device='cuda:0')
ID Accuracy: tensor(0.1006, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 6/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.61it/s]
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.49it/s]



100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.47it/s]
Total time:41.30040526390076
Loss: 5.195065788500237
Validation Loss: 4.700480577295477
HGR Accuracy: tensor(0.0897, device='cuda:0')
ID Accuracy: tensor(0.0952, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 7/150
----------
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:35<00:00,  1.48it/s]


 74%|[32m█████████████████████████████████████▉             [39m| 26/35 [00:04<00:01,  5.49it/s]
Total time:41.63215899467468
Loss: 5.2324228159586585
Validation Loss: 4.700480263449929
HGR Accuracy: tensor(0.0939, device='cuda:0')
ID Accuracy: tensor(0.1055, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.46it/s]
  0%|[34m                                                            [39m| 0/52 [00:00<?, ?it/s]
Epoch 8/150
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.52it/s]


100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.64it/s]
  0%|[34m                                                            [39m| 0/52 [00:00<?, ?it/s]
Total time:40.33279848098755
Loss: 5.1605550014611445
Validation Loss: 4.7004810471968215
HGR Accuracy: tensor(0.0909, device='cuda:0')
ID Accuracy: tensor(0.1024, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 9/150

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.49it/s]


 77%|[32m███████████████████████████████████████▎           [39m| 27/35 [00:05<00:01,  5.12it/s]
Total time:41.59175086021423
Loss: 5.532089755896366
Validation Loss: 4.70048058943315
HGR Accuracy: tensor(0.0945, device='cuda:0')
ID Accuracy: tensor(0.1018, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 10/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.23it/s]

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.49it/s]


 86%|[32m███████████████████████████████████████████▋       [39m| 30/35 [00:05<00:00,  5.71it/s]
Total time:41.509764194488525
Loss: 5.418144657250607
Validation Loss: 4.700480617176403
HGR Accuracy: tensor(0.0945, device='cuda:0')
ID Accuracy: tensor(0.1109, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 11/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.34it/s]

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:35<00:00,  1.46it/s]


 77%|[32m███████████████████████████████████████▎           [39m| 27/35 [00:05<00:01,  4.88it/s]
Total time:42.18682503700256
Loss: 5.422626419067383
Validation Loss: 4.700481019453569
HGR Accuracy: tensor(0.0915, device='cuda:0')
ID Accuracy: tensor(0.0964, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 12/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.27it/s]
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.50it/s]



 89%|[32m█████████████████████████████████████████████▏     [39m| 31/35 [00:06<00:00,  5.47it/s]
Total time:41.34729790687561
Loss: 5.337808089978767
Validation Loss: 4.7004804888638585
HGR Accuracy: tensor(0.0879, device='cuda:0')
ID Accuracy: tensor(0.1079, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 13/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.18it/s]
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.50it/s]


100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.28it/s]
  0%|[34m                                                            [39m| 0/52 [00:00<?, ?it/s]
Total time:41.38135385513306
Loss: 5.470199427171187
Validation Loss: 4.700480903278698
HGR Accuracy: tensor(0.0927, device='cuda:0')
ID Accuracy: tensor(0.1121, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 14/150

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.51it/s]


 83%|[32m██████████████████████████████████████████▎        [39m| 29/35 [00:05<00:01,  5.05it/s]
Total time:41.04693341255188
Loss: 5.312729582353072
Validation Loss: 4.700480466322466
HGR Accuracy: tensor(0.0994, device='cuda:0')
ID Accuracy: tensor(0.0964, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 15/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.31it/s]


















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [01:09<00:00,  1.34s/it]

 66%|[32m█████████████████████████████████▌                 [39m| 23/35 [00:03<00:01,  6.18it/s]
Total time:75.39982342720032
Loss: 5.546969876722856
Validation Loss: 4.700480436845259
HGR Accuracy: tensor(0.0976, device='cuda:0')
ID Accuracy: tensor(0.0915, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 16/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:05<00:00,  6.23it/s]
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:32<00:00,  1.59it/s]


 89%|[32m█████████████████████████████████████████████▏     [39m| 31/35 [00:05<00:00,  5.69it/s]
Total time:38.92279052734375
Loss: 5.4995313679088245
Validation Loss: 4.700480282523415
HGR Accuracy: tensor(0.0903, device='cuda:0')
ID Accuracy: tensor(0.0976, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 17/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.55it/s]
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.52it/s]


 77%|[32m███████████████████████████████████████▎           [39m| 27/35 [00:05<00:01,  5.33it/s]
Total time:40.741485357284546
Loss: 5.63744538047097
Validation Loss: 4.700480634515936
HGR Accuracy: tensor(0.0915, device='cuda:0')
ID Accuracy: tensor(0.0939, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 18/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.34it/s]

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.49it/s]


 86%|[32m███████████████████████████████████████████▋       [39m| 30/35 [00:05<00:00,  5.05it/s]
Total time:41.54906392097473
Loss: 5.452727629921653
Validation Loss: 4.700480676130815
HGR Accuracy: tensor(0.0873, device='cuda:0')
ID Accuracy: tensor(0.0958, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 19/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.20it/s]

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:36<00:00,  1.44it/s]


 74%|[32m█████████████████████████████████████▉             [39m| 26/35 [00:05<00:01,  5.21it/s]
Total time:42.88941216468811
Loss: 5.589104566863089
Validation Loss: 4.70048059983687
HGR Accuracy: tensor(0.0903, device='cuda:0')
ID Accuracy: tensor(0.1024, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 20/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.23it/s]
















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:34<00:00,  1.51it/s]



 86%|[32m███████████████████████████████████████████▋       [39m| 30/35 [00:06<00:00,  5.17it/s]
Total time:41.24572563171387
Loss: 5.313177277536103
Validation Loss: 4.700480813113126
HGR Accuracy: tensor(0.0891, device='cuda:0')
ID Accuracy: tensor(0.1036, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 21/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.10it/s]

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:35<00:00,  1.47it/s]


 86%|[32m███████████████████████████████████████████▋       [39m| 30/35 [00:05<00:00,  5.38it/s]
Total time:42.11550760269165
Loss: 5.476125021269827
Validation Loss: 4.700480660525235
HGR Accuracy: tensor(0.0909, device='cuda:0')
ID Accuracy: tensor(0.1006, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 22/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.25it/s]

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:35<00:00,  1.46it/s]


 83%|[32m██████████████████████████████████████████▎        [39m| 29/35 [00:05<00:01,  5.24it/s]
Total time:42.38166379928589
Loss: 5.744617323441939
Validation Loss: 4.70048018022017
HGR Accuracy: tensor(0.0909, device='cuda:0')
ID Accuracy: tensor(0.1000, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 23/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.15it/s]

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:35<00:00,  1.46it/s]



 97%|[32m█████████████████████████████████████████████████▌ [39m| 34/35 [00:06<00:00,  4.99it/s]
Total time:42.607195138931274
Loss: 5.476966771212491
Validation Loss: 4.700480905012651
HGR Accuracy: tensor(0.0945, device='cuda:0')
ID Accuracy: tensor(0.0982, device='cuda:0')
Validation HGR Accuracy: tensor(0.0909, device='cuda:0')
Validation ID Accuracy: tensor(0.1000, device='cuda:0')
Epoch 24/150
100%|[32m███████████████████████████████████████████████████[39m| 35/35 [00:06<00:00,  5.08it/s]

















100%|[34m███████████████████████████████████████████████████[39m| 52/52 [00:36<00:00,  1.43it/s]
  6%|[32m██▉                                                 [39m| 2/35 [00:00<00:10,  3.28it/s]
Traceback (most recent call last):
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\trainer.py", line 85, in <module>
    train_metrics, val_metrics = train_val(train_dataLoader,
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\epoch.py", line 166, in train_val
    loss_hgr_val_curr, loss_id_val_curr, loss_icgd_val_curr, loss_val_curr, acc_hgr_val_curr, acc_id_val_curr = val_epoch(val_loader,
                                                                                                                ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\epoch.py", line 94, in val_epoch
    loss_icgd_batch = obj_icgd(y_hgr,y_id,f_theta) # ICGD Loss
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS\anaconda3\envs\gpu_torch_5\Lib\site-packages\torch\nn\modules\module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS\anaconda3\envs\gpu_torch_5\Lib\site-packages\torch\nn\modules\module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\icgd.py", line 62, in forward
    id_mask = self.get_IDmask(y_id) # ID mask, shape -> (B,B)
              ^^^^^^^^^^^^^^^^^^^^^
  File "D:\IIT Delhi\Projects\Adversarial games\Experimentation\codeBase\icgd.py", line 33, in get_IDmask
    id_mask_dist = torch.logical_not(torch.eye(B).to(torch.bool)).to(device_id,dtype=torch.float32) # Except diagonal entries everything turned high
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt